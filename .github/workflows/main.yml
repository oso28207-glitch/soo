name: ðŸ“º Series Uploader

on:
  workflow_dispatch:
    inputs:
      series_name:
        description: 'Ø§Ø³Ù… Ø§Ù„Ù…Ø³Ù„Ø³Ù„ (Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠ)'
        required: true
        default: 'afili-ask'
      series_name_arabic:
        description: 'Ø§Ø³Ù… Ø§Ù„Ù…Ø³Ù„Ø³Ù„ (Ø¹Ø±Ø¨ÙŠ)'
        required: true
        default: 'Ø§Ù„Ø­Ø¨ ÙˆØ±Ø·Ø©'
      season_num:
        description: 'Ø±Ù‚Ù… Ø§Ù„Ù…ÙˆØ³Ù…'
        required: true
        default: '1'
        type: number
      start_episode:
        description: 'Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ø­Ù„Ù‚Ø§Øª'
        required: true
        default: '1'
        type: number
      end_episode:
        description: 'Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ø­Ù„Ù‚Ø§Øª'
        required: true
        default: '10'
        type: number

jobs:
  upload-series:
    runs-on: ubuntu-latest
    timeout-minutes: 90   # Ø­Ø¯ Ø£Ù‚ØµÙ‰ 90 Ø¯Ù‚ÙŠÙ‚Ø© (Ù…Ù†Ø§Ø³Ø¨ Ù„Ù€ 10 Ø­Ù„Ù‚Ø§Øª)

    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Setup Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.10'

      - name: Install system deps
        run: |
          sudo apt-get update
          sudo apt-get install -y ffmpeg

      - name: Create config
        run: |
          cat > series_config.json <<EOF
          {
            "series_name": "${{ github.event.inputs.series_name }}",
            "series_name_arabic": "${{ github.event.inputs.series_name_arabic }}",
            "season_num": ${{ github.event.inputs.season_num }},
            "start_episode": ${{ github.event.inputs.start_episode }},
            "end_episode": ${{ github.event.inputs.end_episode }}
          }
          EOF

      - name: Run processor
        env:
          API_ID: ${{ secrets.API_ID }}
          API_HASH: ${{ secrets.API_HASH }}
          CHANNEL: ${{ secrets.CHANNEL }}
          STRING_SESSION: ${{ secrets.STRING_SESSION }}
        run: python main.py
